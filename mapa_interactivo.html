<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mapa Interactivo: Villa Elvira y alrededores</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <style>
      .map-container {
        height: 80vh;
        position: relative;
      }
      .filter-panel {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 1000;
      }
      .legend-panel {
        position: absolute;
        bottom: 10px;
        right: 10px;
        z-index: 1000;
      }
      .high-contrast {
        filter: contrast(1.5);
      }
      #map {
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid p-3">
      <h1 class="text-center">Mapa Interactivo: Villa Elvira y alrededores</h1>
      <p class="text-center">
        Visualiza zonas inundables, caminos seguros y puntos de encuentro en
        tiempo real.
      </p>
    </div>

    <div class="map-container">
      <div
        class="filter-panel card p-3"
        role="region"
        aria-label="Panel de filtros"
      >
        <h2 class="h5">Filtros</h2>
        <div class="mb-3">
          <h3 class="h6">Zonas inundables</h3>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="alto-riesgo"
              checked
            />
            <label class="form-check-label" for="alto-riesgo"
              >Alto riesgo
              <span class="text-danger" aria-hidden="true">●</span></label
            >
          </div>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="riesgo-medio"
              checked
            />
            <label class="form-check-label" for="riesgo-medio"
              >Riesgo medio
              <span class="text-warning" aria-hidden="true">●</span></label
            >
          </div>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="riesgo-bajo"
              checked
            />
            <label class="form-check-label" for="riesgo-bajo"
              >Riesgo bajo
              <span class="text-success" aria-hidden="true">●</span></label
            >
          </div>
        </div>
        <div class="mb-3">
          <h3 class="h6">Caminos seguros</h3>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="rutas-principales"
              checked
            />
            <label class="form-check-label" for="rutas-principales"
              >Rutas principales
              <span class="text-success" aria-hidden="true">─</span></label
            >
          </div>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="rutas-alternativas"
              checked
            />
            <label class="form-check-label" for="rutas-alternativas"
              >Rutas alternativas
              <span class="text-primary" aria-hidden="true">─</span></label
            >
          </div>
        </div>
        <div class="mb-3">
          <h3 class="h6">Puntos de interés</h3>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="refugios"
              checked
            />
            <label class="form-check-label" for="refugios"
              >Refugios <span class="bi bi-house" aria-hidden="true"></span
            ></label>
          </div>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="puntos-encuentro"
              checked
            />
            <label class="form-check-label" for="puntos-encuentro"
              >Puntos de encuentro
              <span class="bi bi-geo-alt" aria-hidden="true"></span
            ></label>
          </div>
          <div class="form-check">
            <input
              type="checkbox"
              class="form-check-input"
              id="centros-asistencia"
              checked
            />
            <label class="form-check-label" for="centros-asistencia"
              >Centros de asistencia
              <span class="bi bi-plus-square" aria-hidden="true"></span
            ></label>
          </div>
        </div>
        <div class="mb-3">
          <label for="fecha-datos" class="form-label">Fecha de datos</label>
          <input
            type="date"
            class="form-control"
            id="fecha-datos"
            value="2023-06-15"
          />
        </div>
        <button
          class="btn btn-primary w-100"
          type="button"
          onclick="applyFilters()"
        >
          Aplicar filtros
        </button>
        <button
          class="btn btn-outline-secondary w-100 mt-2"
          type="button"
          onclick="resetFilters()"
        >
          Restablecer filtros
        </button>
      </div>

      <div
        class="legend-panel card p-3"
        role="region"
        aria-label="Leyenda del mapa"
      >
        <h2 class="h5">Leyenda</h2>
        <ul class="list-unstyled">
          <li>
            <span class="text-danger" aria-hidden="true">●</span> Zona de alto
            riesgo
          </li>
          <li>
            <span class="text-warning" aria-hidden="true">●</span> Zona de
            riesgo medio
          </li>
          <li>
            <span class="text-success" aria-hidden="true">●</span> Zona de
            riesgo bajo
          </li>
          <li>
            <span class="text-success" aria-hidden="true">─</span> Ruta
            principal segura
          </li>
          <li>
            <span class="text-primary" aria-hidden="true">─</span> Ruta
            alternativa
          </li>
          <li><span class="bi bi-house" aria-hidden="true"></span> Refugio</li>
          <li>
            <span class="bi bi-geo-alt" aria-hidden="true"></span> Punto de
            encuentro
          </li>
          <li>
            <span class="bi bi-plus-square" aria-hidden="true"></span> Centro de
            asistencia
          </li>
        </ul>
      </div>

      <div
        id="map"
        class="high-contrast"
        aria-label="Mapa interactivo"
        tabindex="0"
      ></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      // Initialize the map
      var map = L.map("map").setView([-34.92, -57.95], 12); // Approximate coordinates for Villa Elvira, Argentina

      L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 19,
      }).addTo(map);

      // Sample GeoJSON data (replace with real data)
      var geojsonData = {
        type: "FeatureCollection",
        features: [
          {
            type: "Feature",
            properties: { risk: "high" },
            geometry: {
              type: "Polygon",
              coordinates: [
                [
                  [-57.96, -34.93],
                  [-57.94, -34.93],
                  [-57.94, -34.91],
                  [-57.96, -34.91],
                  [-57.96, -34.93],
                ],
              ],
            },
          },
          {
            type: "Feature",
            properties: { risk: "medium" },
            geometry: {
              type: "Polygon",
              coordinates: [
                [
                  [-57.95, -34.92],
                  [-57.93, -34.92],
                  [-57.93, -34.9],
                  [-57.95, -34.9],
                  [-57.95, -34.92],
                ],
              ],
            },
          },
          {
            type: "Feature",
            properties: { risk: "low" },
            geometry: {
              type: "Polygon",
              coordinates: [
                [
                  [-57.97, -34.94],
                  [-57.95, -34.94],
                  [-57.95, -34.92],
                  [-57.97, -34.92],
                  [-57.97, -34.94],
                ],
              ],
            },
          },
        ],
      };

      var geojsonLayer = L.geoJSON(geojsonData, {
        style: function (feature) {
          switch (feature.properties.risk) {
            case "high":
              return { color: "#dc3545", fillOpacity: 0.5 };
            case "medium":
              return { color: "#ffc107", fillOpacity: 0.5 };
            case "low":
              return { color: "#28a745", fillOpacity: 0.5 };
          }
        },
      }).addTo(map);

      // Sample markers
      var markers = [
        {
          type: "refugio",
          coords: [-34.92, -57.95],
          icon: L.divIcon({
            className: "bi bi-house",
            html: '<i class="bi bi-house"></i>',
          }),
        },
        {
          type: "punto-encuentro",
          coords: [-34.91, -57.94],
          icon: L.divIcon({
            className: "bi bi-geo-alt",
            html: '<i class="bi bi-geo-alt"></i>',
          }),
        },
        {
          type: "centro-asistencia",
          coords: [-34.93, -57.96],
          icon: L.divIcon({
            className: "bi bi-plus-square",
            html: '<i class="bi bi-plus-square"></i>',
          }),
        },
      ].forEach((marker) =>
        L.marker(marker.coords, { icon: marker.icon }).addTo(map),
      );

      // Filter functions
      function applyFilters() {
        var filters = {
          "alto-riesgo": document.getElementById("alto-riesgo").checked,
          "riesgo-medio": document.getElementById("riesgo-medio").checked,
          "riesgo-bajo": document.getElementById("riesgo-bajo").checked,
          "rutas-principales":
            document.getElementById("rutas-principales").checked,
          "rutas-alternativas":
            document.getElementById("rutas-alternativas").checked,
          refugios: document.getElementById("refugios").checked,
          "puntos-encuentro":
            document.getElementById("puntos-encuentro").checked,
          "centros-asistencia":
            document.getElementById("centros-asistencia").checked,
        };
        console.log(filters); // Replace with actual filter logic
      }

      function resetFilters() {
        document
          .querySelectorAll(".form-check-input")
          .forEach((cb) => (cb.checked = true));
        applyFilters();
      }
    </script>
  </body>
</html>
